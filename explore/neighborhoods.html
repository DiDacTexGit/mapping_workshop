<!DOCTYPE html>
<html>
    <head>
        <title>Web Mapping Workshop - Zillow Neighborhood Data</title>

        <link rel="stylesheet" href="../lib/leaflet-0.7/leaflet.css" />
        <link rel="stylesheet" href="../styles/reset.css" />
        <link rel="stylesheet" href="../styles/workshop.css" />
    </head>
    <body>
        <style>
            .info {
                padding: 6px 8px;
                font: 14px/16px Arial, Helvetica, sans-serif;
                background: white;
                background: rgba(255,255,255,0.8);
                box-shadow: 0 0 15px rgba(0,0,0,0.2);
                border-radius: 5px;
            }
            .info h4 {
                margin: 0 0 5px;
                color: #777;
            }
        </style>

        <!-- Navigation Start -->
        <nav class="navigation">
            <ul>
                <li><a href="../tutorial/00_introductions.html">Introductions</a></li>
                <li><a href="../tutorial/01_intro2mapping.html">Introduction to Web Mapping</a></li>
                <li><a href="../tutorial/02_intro2leaflet.html">Introduction to Leaflet</a></li>
                <li><a href="../tutorial/03_devenv.html">Development Environment</a></li>
                <li><a href="../tutorial/10_hellomap.html">Making a Map</a></li>
                <li><a href="../tutorial/11_tilesources.html">Base Maps</a></li>
                <li><a href="../tutorial/20_markers.html">Markers</a></li>
                <li><a href="../tutorial/21_popups.html">Pop Ups</a><li>
                <li><a href="../tutorial/30_linestrings.html">Line Data</a></li>
                <li><a href="../tutorial/31_polygons.html">Polygons</a></li>
                <li><a href="../tutorial/40_plugins_markercluster.html">Plugins - Marker Clustering</a></li>
                <li><a href="../tutorial/41_heatmap.html">Plugins - Heatmap</a></li>
                <li><a href="../explore/cfd.html">Civic Hacking &amp; Code for Dayton</a></li>
                <li>
                    <a href="../explore/index.html">Further Explorations</a>
                    <ul>
                        <li><a href="../explore/lotlinker.html">LotLinker</a></li>
                        <li><a href="../explore/neighborhoods.html">Neighborhoods</a></li>
                        <li><a href="../explore/esri.html">ESRI Data</a></li>
                        <li><a href="../explore/airports.html">Airports</a></li>
                        <li><a href="../explore/college.html">Colleges</a></li>
                        <li><a href="../explore/earthquake.html">Earthquakes</a></li>
                    </ul>
                </li>
                <!-- <li>The Starter Project</li>
                <li>Workshop</li>
                <li>Resources</li>-->
            </ul>
        </nav>
        <!-- Navigation End -->

        <section class="content">
            <h1>Neighborhood Data from Zillow.com</h1>
            <div id="mapid" style="width: 100%; height: 400px"></div>
            <h2>Description</h2>
                <p>There are a variety of competing formats for representing GIS data. One of the most common ones when dealing with municipal organizations is the <a href="https://en.wikipedia.org/wiki/Shapefile">Shapefile</a>. This format can be used indirectly by leaflet, but it probably isn't a format you'll want to base your projects around. For this example, we are using the <a href="https://github.com/calvinmetcalf/leaflet.shapefile">leaflet.shapefile</a> plugin. This plugin actually converts the shapefile into GeoJSON before displaying it on the map. Non-optimal, but not terrible for demonstration purposes. This example demonstrates a few things:</p>
                <ul>
                    <li>Using a shapefile directly from a zipfile.</li>
                    <li>Showcases <a href="http://www.zillow.com/">Zillow</a>, which provides <a href="http://www.zillow.com/howto/api/neighborhood-boundaries.htm">neighborhood boundaries</a> licensed under a <a href="https://creativecommons.org/licenses/by-sa/3.0/">Creative Commons license</a>.</li>
                    <li>Uses a custom information control instead of popups.</li>
                    <li>Uses custom mouseover effects.</li>
                    <li>Uses CSS to style the neighborhoods.</li>
                </ul>
            <h2>Data Source</h2>
            <p>As stated above, <a href="http://www.zillow.com/">Zillow</a> is the source of this data.</p>
            <h2>Enhancements</h2>
            <p>Right now, this is a map without a mission, but it could be useful when combined with other data sets. It could be combined with additional map data (<a href="lotlinker.html">LotLinker</a>, or <a href="esri.html">MVRPC ESRI data</a>), or perhaps the info panels could be expanded with more information about the neighborhoods?</p>
            <h2>Resources</h2>
            <ul>
                <li><a href="http://leafletjs.com/examples/choropleth.html">Choropleth example</a> used in creating this example.</li>
                <li><a href="http://leafletjs.com/reference.html#control">Leaflet Controls</a></li>
            </ul>
        </section>

        <script src="../lib/leaflet-0.7/leaflet.js"></script>
        <script src="../lib/shp.js"></script>
        <script src="../lib/leaflet.shpfile.js"></script>
        <script>

            var mymap = L.map('mapid').setView([39.758948, -84.191607], 11);

            L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {
                maxZoom: 18,
                attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
                    '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                    'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
                id: 'mapbox.streets'
            }).addTo(mymap);

            function style(feature) {
                return {
                    fillColor: '#aabbcc',
                    weight: 1,
                    opacity: .6,
                    color: 'black',
                    dashArray: '3',
                    fillOpacity: 0.3
                };
            }

            function highlightFeature(e) {
                var layer = e.target;

                layer.setStyle({
                    weight: 3,
                    color: '#666',
                    dashArray: '',
                    fillOpacity: 0.7
                });

                layer.bringToFront();
                info.update(layer.feature.properties);
            }

            function resetHighlight(e) {
                shpFileLayer.resetStyle(e.target);
                info.update();
            }

            var info = L.control();

            info.onAdd = function (map) {
                this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
                this.update();
                return this._div;
            };

            // method that we will use to update the control based on feature properties passed
            info.update = function (props) {
                this._div.innerHTML = '<h4>Neighborhood Explorer</h4>' +  (props ?
                    '<b>' + props.NAME + '</b><br />' + props.CITY + '<br />' + props.COUNTY
                    : 'Hover over a neighborhood');
            };

            info.addTo(mymap);

            function onEachFeature(feature, layer) {
                layer.on({
                    mouseover: highlightFeature,
                    mouseout: resetHighlight
                });
            }

            var shpFileLayer = new L.Shapefile('data/ZillowNeighborhoods-OH.zip', {
                onEachFeature: onEachFeature,
                style: style
            }).addTo(mymap);

        </script>
    </body>
</html>

